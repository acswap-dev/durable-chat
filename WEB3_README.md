# Web3 聊天应用

这是一个集成了Web3钱包功能的实时聊天应用，用户可以通过连接MetaMask钱包来使用聊天功能。

## 功能特性

- 🔗 **Web3钱包集成**: 支持MetaMask钱包连接
- 💬 **实时聊天**: 基于PartyKit和Durable Objects的实时消息传递
- 👤 **钱包地址显示**: 用户名自动设置为钱包地址（简化显示格式）
- 🔄 **自动账户切换**: 当用户切换MetaMask账户时自动更新
- 🚫 **安全验证**: 只有连接钱包后才能发送消息

## 使用方法

### 1. 安装MetaMask
确保您的浏览器已安装MetaMask钱包扩展。

### 2. 启动应用
```bash
npm run dev
```

### 3. 连接钱包
1. 打开应用后，点击"连接钱包"按钮
2. 在MetaMask弹窗中确认连接
3. 连接成功后，您的用户名将显示为钱包地址的简化格式（如：0x1234...5678）

### 4. 开始聊天
- 连接钱包后，您就可以在聊天框中输入消息并发送
- 其他用户将看到您的钱包地址作为用户名

## 技术实现

### 主要修改
- 添加了`ethers`库用于Web3功能
- 实现了钱包连接/断开功能
- 添加了钱包状态管理
- 集成了MetaMask事件监听
- 修改了UI以支持钱包连接界面

### 核心功能
- `connectWallet()`: 连接MetaMask钱包
- `disconnectWallet()`: 断开钱包连接
- 钱包地址监听：自动响应账户切换
- 消息发送验证：确保只有连接钱包的用户才能发送消息

## 安全特性

- 钱包地址只显示前6位和后4位，保护用户隐私
- 未连接钱包时禁用消息发送功能
- 支持安全的钱包断开操作

## 依赖项

- `ethers`: Web3库，用于与以太坊区块链交互
- `partysocket`: 实时通信
- `react`: 前端框架
- `nanoid`: 唯一ID生成

## 注意事项

- 需要MetaMask钱包扩展
- 支持以太坊主网和测试网
- 钱包连接状态会在页面刷新后重置
- 建议在支持Web3的现代浏览器中使用 